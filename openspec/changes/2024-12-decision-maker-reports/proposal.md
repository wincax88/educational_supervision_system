# 报告决策者功能模块 - Feature Proposal

## Summary

为报告决策者(decision_maker)角色实现完整的评估报告查看与决策辅助功能，支持查看督导评估报告、数据统计分析、区县排名对比等功能。

## Problem Statement

当前系统中报告决策者角色存在以下问题：

1. 角色已定义但功能页面未实现（仅显示占位符）
2. 缺少评估报告的展示和导出功能
3. 没有数据统计和可视化分析
4. 无法支持决策者做出基于数据的决策

## User Role Definition

**报告决策者 (decision_maker)**
- 角色定位：教育管理层（教育局领导、督学等）
- 核心需求：基于督导评估结果做出决策
- 权限特点：只读型角色，可查看但不可修改数据

## Proposed Solution

### Phase 1: 报告查看核心功能

1. **评估报告列表**
   - 展示所有已完成评估的项目
   - 支持按项目类型、年度、状态筛选
   - 显示项目基本信息和评估完成时间

2. **报告详情查看**
   - 项目基本信息概览
   - 各指标评估结果展示
   - 区县/学校的详细评估数据
   - 专家评审意见汇总

3. **报告导出**
   - 支持导出 PDF 格式正式报告
   - 支持导出 Excel 数据明细
   - 自定义报告模板

### Phase 2: 数据统计与可视化

1. **统计看板**
   - 项目总体完成情况
   - 达标率统计
   - 关键指标汇总

2. **区县排名**
   - 各区县综合评估得分排名
   - 单项指标排名对比
   - 排名变化趋势

3. **数据可视化**
   - 指标得分雷达图
   - 达标率柱状图
   - 趋势折线图
   - 问题分布饼图

### Phase 3: 决策辅助功能

1. **预警提醒**
   - 不达标项目预警
   - 薄弱指标预警
   - 整改超期提醒

2. **对比分析**
   - 历年数据对比
   - 区县横向对比
   - 同类指标对比

3. **整改跟踪**（可选）
   - 问题整改进度查看
   - 整改结果验收状态

## Implementation Tasks

### 数据库

- [ ] 创建 `evaluation_reports` 报告表（如需独立存储）
- [ ] 创建 `report_snapshots` 报告快照表
- [ ] 添加报告状态和发布时间字段

### 后端 API

- [ ] GET `/api/reports` - 获取报告列表
- [ ] GET `/api/reports/:projectId` - 获取项目评估报告详情
- [ ] GET `/api/reports/:projectId/export` - 导出报告
- [ ] GET `/api/reports/statistics` - 获取统计数据
- [ ] GET `/api/reports/rankings` - 获取区县排名

### 前端页面

- [ ] ReportList - 报告列表页面
- [ ] ReportDetail - 报告详情页面
- [ ] ReportStatistics - 统计看板页面
- [ ] DistrictRanking - 区县排名页面

### 前端组件

- [ ] ReportCard - 报告卡片组件
- [ ] IndicatorScoreTable - 指标得分表格
- [ ] RadarChart - 雷达图组件
- [ ] RankingTable - 排名表格组件
- [ ] ExportButton - 导出按钮组件
- [ ] StatisticCard - 统计卡片组件

### 路由配置

- [ ] `/reports` - 报告列表（默认入口）
- [ ] `/reports/:projectId` - 报告详情
- [ ] `/reports/statistics` - 统计看板
- [ ] `/reports/rankings` - 区县排名

## UI/UX Design

### 报告列表页面布局

```
+------------------------------------------+
| 评估报告                      [筛选] [搜索] |
+------------------------------------------+
| 项目类型: [全部] [义务教育] [学前教育]      |
| 年度: [2024] [2023] [2022]               |
+------------------------------------------+
| +-------------+ +-------------+          |
| | 项目卡片 1   | | 项目卡片 2   |          |
| | 名称/状态    | | 名称/状态    |          |
| | 评估时间     | | 评估时间     |          |
| | [查看报告]   | | [查看报告]   |          |
| +-------------+ +-------------+          |
+------------------------------------------+
```

### 报告详情页面布局

```
+------------------------------------------+
| < 返回                      [导出PDF] [导出Excel] |
+------------------------------------------+
| 项目名称                                   |
| 评估时间: 2024-12-20  状态: 已完成          |
+------------------------------------------+
| [概览] [指标详情] [区县数据] [专家意见]      |
+------------------------------------------+
|                                          |
| 概览标签页内容:                            |
| +------------+ +------------+            |
| | 达标率 85% | | 参评区县 12 |            |
| +------------+ +------------+            |
|                                          |
| 雷达图 / 柱状图                            |
|                                          |
+------------------------------------------+
```

## Success Criteria

1. 决策者能够查看所有已完成评估项目的报告
2. 报告详情完整展示各项指标评估结果
3. 支持 PDF 和 Excel 格式导出
4. 统计图表正确展示数据分析结果
5. 区县排名数据准确且可按指标筛选
6. 页面加载性能良好（首屏 < 2s）

## Dependencies

- 项目管理模块（project-management）
- 指标体系库（indicator-library）
- 数据采集功能（已完成采集的数据）
- 专家评审功能（评审意见数据）

## Risks

1. **数据完整性**: 报告依赖完整的评估数据
   - 缓解: 增加数据完整性检查，缺失数据给出提示

2. **报告格式**: PDF 导出格式需求可能多样
   - 缓解: 提供模板配置，支持自定义样式

3. **性能问题**: 大量数据的统计可能较慢
   - 缓解: 预计算统计数据，使用缓存

## Priority

- **P0 - 必须实现**: 报告列表 + 报告详情 + 基础导出
- **P1 - 应该实现**: 统计看板 + 区县排名
- **P2 - 可以实现**: 历史对比 + 可视化图表
- **P3 - 锦上添花**: 预警提醒 + 整改跟踪
